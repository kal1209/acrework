<html>

<head>
    <meta charset="UTF-8" />
    <title>Edit Scene</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
</head>

<body style="margin: 0px;">
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.52.0/dist/phaser.js"></script>
    <!-- jQuery library -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>

    <script src="../scenes/EditSceneScene.js"></script>

    <script type="text/javascript">
        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);

        if (urlParams.get('scene_id') == '') {
            sceneId = Math.random().toString(36).slice(-9);
        }

        var config = {
            type: Phaser.AUTO,
            scale: {
                mode: Phaser.Scale.FIT,
                autoCenter: Phaser.Scale.CENTER_BOTH,
            },
            width: parseInt('<%= width %>'),
            height: parseInt('<%= height %>'),
            loader: {
                crossOrigin: 'anonymous'
            },
            physics: {
                default: 'arcade',
                arcade: {
                    // debug: true,
                    // debugShowBody: true
                }
            },
            parent: 'phaser',
            dom: {
                createContainer: true
            },
            scene: [
                EditSceneScene,
            ]
        };

        var game = new Phaser.Game(config);
        game.scene.start("EditSceneScene");
    </script>

    <script type="text/javascript">
        $(function () {
            $(document).on('click', '.btn-save', function () {
                $.ajax({
                    url: "save_scene",
                    type: "POST",
                    dataType: 'json',
                    data: {
                        project_id: '<%= _id %>',
                        scene: {
                            id: sceneId,
                            situation: situation,
                        },
                    },
                    success: async function (res) {
                        if (res.success) {
                        }
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        console.log('error');
                    }
                });
            });
        })
    </script>

    <script src="../config/items.js"></script>
</body>

</html>